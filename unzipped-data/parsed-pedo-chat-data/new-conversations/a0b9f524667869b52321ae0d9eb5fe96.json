{
    "id": "a0b9f524667869b52321ae0d9eb5fe96",
    "messages": [
        "4d647473081c3ad729446a01a377813b (17:50): is there an easy .htaccess line to kill the connection if someone uses a certain browser?",
        "4d647473081c3ad729446a01a377813b (17:52): or a more friendly heuristic, if the URI contains &quot;&amp;amp;&quot;",
        "4d647473081c3ad729446a01a377813b (18:02): SetEnvIf Request_URI &quot;&amp;amp;&quot; evil",
        "4d647473081c3ad729446a01a377813b (18:02): Deny from evil",
        "4d647473081c3ad729446a01a377813b (18:02): ?",
        "4d647473081c3ad729446a01a377813b (18:04): Deny from env=evil",
        "4d647473081c3ad729446a01a377813b (18:08): hmm, that doesn't work",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:10): SetEnvIf Request_URI &quot;&amp;amp;&quot; evil=1",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:11): ?",
        "4d647473081c3ad729446a01a377813b (18:11): nope",
        "4d647473081c3ad729446a01a377813b (18:11): the documentation is crap",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:12): oh yeah, looks like that's redundant. You have &lt;FilesMatch &quot;(.*)&quot;&gt; \\n Order Allow,Deny \\n Allow from all \\n Deny from env=evil \\n &lt;/FilesMatch&gt;",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:13): (specifically the order bit?)",
        "4d647473081c3ad729446a01a377813b (18:13): currently no",
        "4d647473081c3ad729446a01a377813b (18:13): can they appear inside &lt;FilesMatch?",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:14): that's the way I have it - which works for me. :)",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:15): (but the problem with .htaccess is that there's so many other things setting up things inside it that there's a high chance of conflicts...)",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:15): well, _a_ problem.",
        "4d647473081c3ad729446a01a377813b (18:15): no, doesn't work",
        "4d647473081c3ad729446a01a377813b (18:15): there's almost nothing configured here",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:16): pastebin the entire .htaccess file?",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:16): wfm: http://juima.org/stuff/test&amp;amp;test",
        "4d647473081c3ad729446a01a377813b (18:17): http://html5.org/x.htaccess",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:19): iirc the latter option overrides the former, hence allow,deny instead of deny,allow (blaklisting versus whitelisting)",
        "4d647473081c3ad729446a01a377813b (18:20): i tried that too",
        "4d647473081c3ad729446a01a377813b (18:20): will try again",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:20): what I have is http://pastebin.com/d7a7644ea",
        "ab7faae5d7b250ea8606486575f8f79c (18:21): Maybe mod_rewrite would be easier",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:21): &quot;Deny,Allow: First, all Deny directives are evaluated; if any match, the request is denied unless it also matches an Allow directive.&quot;",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:22): that's the problem with the current version",
        "4d647473081c3ad729446a01a377813b (18:22): it seems that for query strings it does not work?",
        "4d647473081c3ad729446a01a377813b (18:22): can that be true?",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:22): yes",
        "4d647473081c3ad729446a01a377813b (18:22): see e.g. http://juima.org/stuff/?test&amp;amp;test",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:22): querystring isn't part of request_uri",
        "4d647473081c3ad729446a01a377813b (18:22): geez",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:22): meh, should've remembered that immediately.",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:22): yeah, that sucks",
        "4d647473081c3ad729446a01a377813b (18:22): do you know the variable?",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:22): remembers being frustrated by it not two months ago",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:23): iirc there isn't one, and I indeed moved to mod_rewrite as ab7faae5d7b250ea8606486575f8f79c suggested. Back then it was:",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:23): RewriteCond %{QUERY_STRING} DECLARE",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:23): RewriteRule ^(.*) - [F]",
        "4d647473081c3ad729446a01a377813b (18:24): &quot;See the RewriteCond directive of mod_rewrite for extra information on how to match your query string.&quot; sigh",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:24): so s/DECLARE/&amp;amp;/ and put a RewriteEngine On above it.",
        "4d647473081c3ad729446a01a377813b (18:25): nice",
        "4d647473081c3ad729446a01a377813b (18:25): there is this bot hitting web-apps-tracker for a couple of months now and eating 15 gigabytes a month or so",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:26): youch",
        "4d647473081c3ad729446a01a377813b (18:26): it apparently fetches &amp;amp; URIs",
        "4d647473081c3ad729446a01a377813b (18:31): seems to work",
        "ab7faae5d7b250ea8606486575f8f79c (18:31): I wish there was a nicer way to write RewriteRule when you don't actually care about the URIs",
        "4d647473081c3ad729446a01a377813b (18:31): serving lots of 403",
        "ab7faae5d7b250ea8606486575f8f79c (18:32): I suppose &quot;RewriteRule . - [F]&quot; is the most concise thing you can do",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:32): The bot doesn't come from a single ip? In extreme cases I just toss them in iptables so I don't even have the apache hit.",
        "4d647473081c3ad729446a01a377813b (18:35): nope, lots of different IPs",
        "ab7faae5d7b250ea8606486575f8f79c (18:36): Whose IPs are they?",
        "4d647473081c3ad729446a01a377813b (18:37): opens access.log again",
        "4d647473081c3ad729446a01a377813b (18:39): 59.173.21.194, 82.161.78.95, 62.171.194.43, 80.255.43.29, etc.",
        "ab7faae5d7b250ea8606486575f8f79c (18:43): Does not exist, haarlemwms.demon.nl, proxy-23.swgfl.ifl.net, does not exist",
        "ab7faae5d7b250ea8606486575f8f79c (18:43): Doesn't look like much of a pattern in there yet",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:44): I've seen 62.171.194.43 legitimately browsing on my site",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:44): (came in via google image search, loads css files and images, etc)",
        "4d647473081c3ad729446a01a377813b (18:45): 88.247.148.23",
        "0c25ae3066f1b9f7890ceff405fdcab1 (18:46): 'course, since it's a proxy...",
        "4d647473081c3ad729446a01a377813b (18:46): 80.90.160.97",
        "4d647473081c3ad729446a01a377813b (18:46): 200.68.29.118",
        "ab7faae5d7b250ea8606486575f8f79c (18:47): dsl88-247-37911.ttnet.net.tr, does not exist, mail.tucapel.cl",
        "4d647473081c3ad729446a01a377813b (18:47): maybe they're all proxies in some way?",
        "ab7faae5d7b250ea8606486575f8f79c (18:48): Maybe it's a botnet trying to DDOS the spec tracker",
        "b8810fee2f4a71f849f3f7409546d1d9 (18:50): :-( making content-language non-conforming without changing the processing reqs seems impractical",
        "4d647473081c3ad729446a01a377813b (18:51): ab7faae5d7b250ea8606486575f8f79c, haha, nice try Mr. Last Week!"
    ],
    "person_ids": [
        "4d647473081c3ad729446a01a377813b",
        "0c25ae3066f1b9f7890ceff405fdcab1",
        "ab7faae5d7b250ea8606486575f8f79c",
        "b8810fee2f4a71f849f3f7409546d1d9"
    ]
}