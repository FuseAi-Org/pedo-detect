{
    "id": "13f2174a6128c22d6704e28487433e0e",
    "messages": [
        "69b0d3dfe919a6b860a9fac82de52a7e (09:54): does IE8 not support incremental loading of HTML content?",
        "69b0d3dfe919a6b860a9fac82de52a7e (09:54): http://www.hixie.ch/tests/adhoc/dom/level0/timers/nph-009-demo.html for me in IE has it wait til the whole thing is loaded before parsing anything",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:06): 69b0d3dfe919a6b860a9fac82de52a7e: if we make createContextualFragment create scripts that are script-created and don't have their 'already started' flag set, would you be OK with adding a parameter to the HTML fragment parsing algorithm for controlling script execution prevention?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:06): what's createContextualFragment()?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:07): is it like insertAdjacentHTML()?",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:07): 69b0d3dfe919a6b860a9fac82de52a7e: it runs the fragment parsing algorithm with a string input and a context node and returns the corresponding DOM fragment",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:07): or is it the DOM Range thing?",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:07): 69b0d3dfe919a6b860a9fac82de52a7e: it's the Range thing",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:07): hmm",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:07): I think insertAdjacentHTML() should prevent execution",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:08): what's the use case for inserting scripts with createContextualFragment?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:08): if we can get away with it just not executing scripts that sounds best to me",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:08): 69b0d3dfe919a6b860a9fac82de52a7e: currently, the main use case is emulating insertAdjacentHTML in browsers that don't have it *yet*",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:09): in that case, yeah, not running scripts seems best",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:09): (there are browsers with createContextualFragment but not insertAdjacentHTML?)",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:09): 69b0d3dfe919a6b860a9fac82de52a7e: but once insertAdjacentHTML is supported, if you think of createContextualFragment  as a standalone feature, it's a shortcut for building a DOM fragment",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:09): 69b0d3dfe919a6b860a9fac82de52a7e: Gecko",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:09): wow, i thought iAH was a mozillaism",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:09): shows what i know",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:09): 69b0d3dfe919a6b860a9fac82de52a7e: and if you built the DOM fragment manually, the scripts would be executable",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:09): so it's illogical for the shortcut to make scripts unexecutable",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:09): well the same could be said of innerHTML",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:09): the scripts are executable in Firefox 3.6 and in Opera",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:10): but it still blocks script execution",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:10): but not in WebKit",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:10): 69b0d3dfe919a6b860a9fac82de52a7e: only because other browsers cloned IE imprecisely and the execution prevention became the norm",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:10): for innerHTML that is",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:11): innerHTML not running scripts is definitely a plus in my book, given how much that simplifies so many complicated things",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:11): but anyway",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:11): how does innerHTML stop script creation currently?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:11): does the fragment algorithm just block it?",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:11): if I were just lazy, preventing script execution for createContextualFragment would be easy, but I'm inclined to think that not preventing execution is the Right Thing",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:13): 69b0d3dfe919a6b860a9fac82de52a7e: the fragment parsing algorithm sets 'already started'",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:13): oh, i see, the parser does",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:13): hm, that makes parsing a flag a bit of a pain, but we could do it i guess",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:13): tbh i'd strongly recommend just not running scripts unless you have a very clear use case that needs it. (i mean an actual use case, not &quot;build a DOM&quot; or &quot;emulate this other API&quot;)",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:14): running scripts in weird places is one of the main causes of there being arcane parts to the platform",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:14): 69b0d3dfe919a6b860a9fac82de52a7e: the annoying part is that people who've filed WebKit and Gecko bugs about this just say what behavior they want--not what their use case was",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:14): yeah, i hear ya",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:15): i'm battling the i18n wg as we speak over doing exactly that",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:15): 69b0d3dfe919a6b860a9fac82de52a7e: the current plan is the run scripts from fragments created by XSLTPrecessor, so we'd still have to support fragments with executable scripts",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:15): and of course manually built ones",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:15): does anyone actually use xslt to generate scripts?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:15): that's just frightening",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:16): who knows what Dark Matter does with XSLTProcessor",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:16): instrument the code and find out",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:16): 69b0d3dfe919a6b860a9fac82de52a7e: as for scripts created via &lt;?xml-stylesheet?&gt;, there's a Chrome Experement doing that",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:17): which is why the issue is now on my plate",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:17): feel free to break chrome experiments",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:17): i'm happy to take the blame at google for that",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:18): 69b0d3dfe919a6b860a9fac82de52a7e: I believe that would be against our privacy principles to instrument code without a Test Pilot opt-in",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:18): sure, i wasn't suggesting doing it without user consent",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:18): i just meant in a special build or something",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:18): don't you have betas specifically for this purpose?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:18): i mean, instrumented betas",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:18): not necessarily the main beta line",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:19): I'm not aware of Mozilla doing intrumented betas",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:19): ah",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:19): well",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:19): get the chrome team to do it",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:19): and even if we did, there'd be the problem of getting Dark Matter users to use them",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:19): 8b7a8196348038c107614af0b08f2d21 will likely be happy to set it up",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:19): what's Dark Matter? I thought you just meant random people Out There.",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:19): 69b0d3dfe919a6b860a9fac82de52a7e: enterprise intranets",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:20): or extranets",
        "8b7a8196348038c107614af0b08f2d21 (10:20): you're going to run scripts from fragments?",
        "8b7a8196348038c107614af0b08f2d21 (10:20): that seems crazy :)",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:20): yeah well if we're going to live in fear of breaking enterprise intranets, we'll just end up in analysis paralysis",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:20): 8b7a8196348038c107614af0b08f2d21: is non-running in WebKit by design or by accident?",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:21): 69b0d3dfe919a6b860a9fac82de52a7e: why would be go ahead and break stuff that used to work just for the sake of making scripts run less?",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:21): s/be/we/",
        "8b7a8196348038c107614af0b08f2d21 (10:21): there are architectural problems with running scripts without a frame in webkit",
        "8b7a8196348038c107614af0b08f2d21 (10:21): the JavaScript engine can do it",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:22): 8b7a8196348038c107614af0b08f2d21: oh, I don't mean running scripts while they aren't in a DOM that's in a browsing contenxt",
        "8b7a8196348038c107614af0b08f2d21 (10:22): but the code that knows how to talk to the JavaScript engine would be very confused",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:22): *context",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:22): b8810fee2f4a71f849f3f7409546d1d9: making scripts run less seems like a goal in and of itself to me. certainly in weird places like xslt where the security and interoperability implications are rather esoteric and not necessarily understood by many people.",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:22): 8b7a8196348038c107614af0b08f2d21: I mean running scripts when a fragment is inserted into a DOM that's being displayed in a browsing context",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:22): which reminds me that I was about to file a spec bug about not running scripts that are in a document but the document doesn't have a browsing context",
        "8b7a8196348038c107614af0b08f2d21 (10:22): ah, that's technically feasible",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:23): 8b7a8196348038c107614af0b08f2d21: the specific case we're talking about instrumenting is the output of XSLT transforms that contain scripts",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:23): 8b7a8196348038c107614af0b08f2d21: see http:/ b8810fee2f4a71f849f3f7409546d1d9.iki.fi/test/moz/scripts/",
        "8b7a8196348038c107614af0b08f2d21 (10:23): scripts = script tags ?",
        "8b7a8196348038c107614af0b08f2d21 (10:23): or do inline event handlers count too?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:23): i think in gecko it creates an actual dom",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:23): 8b7a8196348038c107614af0b08f2d21: script nodes",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:23): 8b7a8196348038c107614af0b08f2d21: http:/ b8810fee2f4a71f849f3f7409546d1d9.iki.fi/test/moz/scripts/createContextualFragment.html",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:24): anyway, if xslt is defined in terms of just creating a dom or a serialisation that's then parsed, it seems that this all just falls out of the spec as is",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:24): 8b7a8196348038c107614af0b08f2d21: http:/ b8810fee2f4a71f849f3f7409546d1d9.iki.fi/test/moz/scripts/XSLTProcessor-transformToFragment.html",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:24): how is xslt defined? (is it defined?)",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:24): 8b7a8196348038c107614af0b08f2d21: those two run the script in Firefox 3.6 and in Opera 10.63 but not in WebKit",
        "8b7a8196348038c107614af0b08f2d21 (10:24): i think all these code paths chase down the same path as innerHTML",
        "8b7a8196348038c107614af0b08f2d21 (10:24): for inline scripts",
        "8b7a8196348038c107614af0b08f2d21 (10:25): the parser is responsible for kicking off script execution",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:25): 8b7a8196348038c107614af0b08f2d21: it's easy to see how you'd accidentally make createContextualFragment prevent execution by reusing innerHTML infrastructure",
        "8b7a8196348038c107614af0b08f2d21 (10:25): but it doesn't do that if there's no frame",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:25): 8b7a8196348038c107614af0b08f2d21: but http:/ b8810fee2f4a71f849f3f7409546d1d9.iki.fi/test/moz/scripts/XSLTProcessor-transformToFragment.html is different",
        "8b7a8196348038c107614af0b08f2d21 (10:25): to answer your question, i have no idea whether its intentional",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:25): 8b7a8196348038c107614af0b08f2d21: ok",
        "8b7a8196348038c107614af0b08f2d21 (10:26): i think XSLT was added because someone at IBM complained",
        "8b7a8196348038c107614af0b08f2d21 (10:26): i'm not sure how many people actually care about it",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:28): IE's behaviour on http://www.hixie.ch/tests/adhoc/dom/level0/timers/nph-010-demo.html is shocking to me",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:29): does IE really wait until the document is entirely loaded before doing anything?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:29): surely i'm just doing something wrong",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:30): 69b0d3dfe919a6b860a9fac82de52a7e: fwiw, I believe the closest thing to an XSLTProcessor spec is https://developer.mozilla.org/en/Using_the_Mozilla_JavaScript_interface_to_XSL_Transformations",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:31): well transformToDocument should definitely not run the scripts",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:32): but i guess if you want the &quot;already executed&quot; flag to not be set, so long as the execution only happens once the stuff is inserted into the real document and not the innerHTML document, i guess we could finagle that",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:33): it'd be a bit of a hack... the reason the spec right now sets &quot;already executed&quot; the way it does, in addition to being ok for compat for innerHTML, is that the Document it's parsing into has no global scope",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:33): so it can't run script anyway",
        "8b7a8196348038c107614af0b08f2d21 (10:34): what's the benefit of running scripts?",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:35): it's unclear to me that there is one",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:35): 8b7a8196348038c107614af0b08f2d21: at least jQuery goes through trouble to make itself a fragment parser that does run scripts",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:35): i'd much rather just not run them",
        "8b7a8196348038c107614af0b08f2d21 (10:36): interesting",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:36): JohnResig: do you have input for use cases for or against createContextualFragment creating executable scripts?",
        "8b7a8196348038c107614af0b08f2d21 (10:36): i still think we should have some way of parsing a fragment that lets you whitelist tags and attributes",
        "8b7a8196348038c107614af0b08f2d21 (10:37): its not really related, but its very popular in server-side frameworks",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:37): though it's unclear if jQuery would benefit from the behavior that would result from createContextualFragment creating executable script nodes, because those scripts wouldn't execute in order when the fragment is inserted to the DOM",
        "8b7a8196348038c107614af0b08f2d21 (10:38): :)",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:39): it would be so nice if people filing these bugs said more about their higher-level use cases",
        "69b0d3dfe919a6b860a9fac82de52a7e (10:41): agreed",
        "b8810fee2f4a71f849f3f7409546d1d9 (10:55): I asked the reporters to elaborate on their use cases in both bugzillas",
        "cc097e0d7183ae8436e7df709553c8c0 (11:04): whatwg.org is really really slow for me. just me?"
    ],
    "person_ids": [
        "69b0d3dfe919a6b860a9fac82de52a7e",
        "b8810fee2f4a71f849f3f7409546d1d9",
        "8b7a8196348038c107614af0b08f2d21",
        "cc097e0d7183ae8436e7df709553c8c0"
    ]
}