{
    "id": "dc56479700d6d061555ecd96332618e2",
    "messages": [
        "ad7340c0d2664b131f969961d78c86b2 (22:15): 69b0d3dfe919a6b860a9fac82de52a7e: are you about?",
        "b25b6b77a0087ff8385941e5545d32ea (22:19): It kinda makes sense that you would fund theora on mobile devices and something new for non-mobile if all of the above were true",
        "b25b6b77a0087ff8385941e5545d32ea (22:19): Since mobile devices typically don't need to do HD",
        "b25b6b77a0087ff8385941e5545d32ea (22:20): ad7340c0d2664b131f969961d78c86b2: (I suggest you just ask and 69b0d3dfe919a6b860a9fac82de52a7e will reply when he is around)",
        "ad7340c0d2664b131f969961d78c86b2 (22:21): okay, well, with websockets, and sending the body on the request without a Content-Length or Transfer-Encoding seems to go against RFC2068",
        "ad7340c0d2664b131f969961d78c86b2 (22:21): &quot;The presence of a message-body in a request is signaled by the inclusion of a Content-Length or Transfer-Encoding header field in the request's message-headers&quot;",
        "b25b6b77a0087ff8385941e5545d32ea (22:22): So the hypothetical architecture is one where the HTTP server handles the entire request including the random bytes and then passes it off to a websockets handler",
        "ad7340c0d2664b131f969961d78c86b2 (22:23): yeah, sorta",
        "b25b6b77a0087ff8385941e5545d32ea (22:23): Couldn't you just treat it like a request with no body and then have the WS server read 8 bytes from the network to get the random bytes?",
        "b25b6b77a0087ff8385941e5545d32ea (22:23): I mean at some point you have to hand over to WS-specific code",
        "ad7340c0d2664b131f969961d78c86b2 (22:24): no. because the body is separated from the headers with \\r\\n\\r\\n",
        "b25b6b77a0087ff8385941e5545d32ea (22:29): So you only have a problem if the HTTP layer reads the headers, notices it is a websocket client, hands over to the websocket server, but also reads the body (even though the headers don't say there is a body) and doesn't make that avaliable to the WS server",
        "b25b6b77a0087ff8385941e5545d32ea (22:30): It's not clear to me why that would happen",
        "b25b6b77a0087ff8385941e5545d32ea (22:30): (it seems you could get into trouble with either design)",
        "ad7340c0d2664b131f969961d78c86b2 (22:32): hmm..",
        "ad7340c0d2664b131f969961d78c86b2 (22:32): well, I've found a really hacked fix, not sure if it'll work though",
        "ad7340c0d2664b131f969961d78c86b2 (22:40): I'm beginning to think it was easier to write my own header handler",
        "b25b6b77a0087ff8385941e5545d32ea (22:40): If you have the choice I expect it is",
        "b25b6b77a0087ff8385941e5545d32ea (22:41): I *think* parsing the initial headers is not that hard",
        "ad7340c0d2664b131f969961d78c86b2 (22:44): I just hope every browser / client that implements websockets get's it write.",
        "ad7340c0d2664b131f969961d78c86b2 (22:44): *right",
        "ad7340c0d2664b131f969961d78c86b2 (22:44): b25b6b77a0087ff8385941e5545d32ea: do you think it'd be possible for the body to be separated from the request at any stage?",
        "ad7340c0d2664b131f969961d78c86b2 (22:45): ie, rather then it being: &quot;GET ... \\r\\n .... \\r\\n\\r\\nBODY\\r\\n\\r\\n&quot;",
        "ad7340c0d2664b131f969961d78c86b2 (22:46): it gets received as &quot;GET ... \\r\\n ... \\r\\n\\r\\n&quot; and then later &quot;BODY\\rn\\r\\n&quot;",
        "71bd9426656c7068876f52fb7934af7f (22:53): ad7340c0d2664b131f969961d78c86b2, that is entirely possible",
        "ad7340c0d2664b131f969961d78c86b2 (22:53): damn",
        "ad7340c0d2664b131f969961d78c86b2 (22:53): not the answer I was hoping for",
        "3501532e992dae83a8bc6c811325317e (22:54): Good morning.",
        "ad7340c0d2664b131f969961d78c86b2 (22:55): In which case I have no idea how I'm going to handle the http headers / meta for websocket connections..",
        "71bd9426656c7068876f52fb7934af7f (22:57): ad7340c0d2664b131f969961d78c86b2,  i don't understand why you can't hand the stream over to the websocket server",
        "ad7340c0d2664b131f969961d78c86b2 (22:57): uh. I'm writing the server",
        "ad7340c0d2664b131f969961d78c86b2 (22:58): so, how I go about parsing the headers from the clients is fairly important",
        "71bd9426656c7068876f52fb7934af7f (22:58): i mean your server",
        "71bd9426656c7068876f52fb7934af7f (22:58): to clarify: hand the stream from the http code that parsed the request headers to the websocket code",
        "ad7340c0d2664b131f969961d78c86b2 (22:58): oh, wait, my WebSocket server is reading the stream, it's a matter of parsing the headers",
        "ad7340c0d2664b131f969961d78c86b2 (22:59): umm.. because, I'm implementing my server on top of network sockets, not a http server",
        "71bd9426656c7068876f52fb7934af7f (22:59): so you are parsing everything from byte 1 in your own websocket code",
        "ad7340c0d2664b131f969961d78c86b2 (22:59): yes",
        "71bd9426656c7068876f52fb7934af7f (23:00): does your server understand websocket and http or just websocket",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:00): beowulf: 69b0d3dfe919a6b860a9fac82de52a7eThePixie http://bfbc2.statsverse.com/stats/ps3 69b0d3dfe919a6b860a9fac82de52a7eThePixie",
        "ad7340c0d2664b131f969961d78c86b2 (23:00): it understands the websocket, however, needs to handle the http request sent for the websocket client initialisation",
        "71bd9426656c7068876f52fb7934af7f (23:01): and you are using an http library for that or writing your own header parsing code?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:01): ad7340c0d2664b131f969961d78c86b2: anything i can help with re websockets? (i haven't read the backlog)",
        "ad7340c0d2664b131f969961d78c86b2 (23:01): it'd be much better if the websocket spec said that the Content-Length field needed to be set",
        "ad7340c0d2664b131f969961d78c86b2 (23:01): 69b0d3dfe919a6b860a9fac82de52a7e: that ^^",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:02): Content-Length: 0?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:02): i thought that was implied by the GET",
        "ad7340c0d2664b131f969961d78c86b2 (23:02): it'd have to be Content-Length: 8",
        "ad7340c0d2664b131f969961d78c86b2 (23:02): for the 8 bits",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:02): the 8 bytes aren't part of the GET request",
        "ad7340c0d2664b131f969961d78c86b2 (23:02): and no, it's not implied by the GET",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:02): they're the first 8 bytes after the upgrade",
        "ad7340c0d2664b131f969961d78c86b2 (23:03): 0x0D 0x0A == \\r\\n, yeah?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:03): yep",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:03): (unless you're using perl on windows)",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:03): (or have changed the \\n magic variable)",
        "a924fb58d2c25874322f4e5126f608b9 (23:03): ... you're kidding",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:03): (iirc $/)",
        "ad7340c0d2664b131f969961d78c86b2 (23:03): in which case, the key3 value would be the body of the HTTP request",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:04): GETs don't have bodies if they don't have a Content-Length",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:04): just handle it in the same code you're going to use to handle the websocket frames",
        "ad7340c0d2664b131f969961d78c86b2 (23:04): um.. although, the request will probably look like..",
        "ad7340c0d2664b131f969961d78c86b2 (23:06): http://gist.github.com/365024",
        "ad7340c0d2664b131f969961d78c86b2 (23:07): 69b0d3dfe919a6b860a9fac82de52a7e: or am I wrong in thinking that?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:08): there's no \\r\\n after the 8 bytes",
        "ad7340c0d2664b131f969961d78c86b2 (23:08): okay, well, any rate, leave off one and it would work?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:08): the first byte after the 8th byte will be a 0x00 byte from the first frame",
        "ad7340c0d2664b131f969961d78c86b2 (23:10): okay",
        "ad7340c0d2664b131f969961d78c86b2 (23:10): so, removing the two \\r\\n\\r\\n at the end of that data, and it's right?",
        "ad7340c0d2664b131f969961d78c86b2 (23:10): eg, ...le.com\\r\\n\\r\\n^n:ds[4U",
        "ad7340c0d2664b131f969961d78c86b2 (23:12): hmm..",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:12): looks right",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:12): but i haven't checked the details",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:12): there's some examples in the spec if that helps",
        "ad7340c0d2664b131f969961d78c86b2 (23:13): yeah, I'm constantly cross-referencing stuff",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:13): cool",
        "ad7340c0d2664b131f969961d78c86b2 (23:14): I'm wanting to make sure this client is spec-compliant",
        "ad7340c0d2664b131f969961d78c86b2 (23:14): I'm still not sure if I want it to drop connections not using Sec-* (ie, all current webbrowser clients)",
        "ad7340c0d2664b131f969961d78c86b2 (23:19): 69b0d3dfe919a6b860a9fac82de52a7e: any opinions on that?",
        "ad7340c0d2664b131f969961d78c86b2 (23:22): 69b0d3dfe919a6b860a9fac82de52a7e: at any rate, thanks for the clarification and help :)",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:22): well right now the spec isn't done",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:22): so anything you do is going to need to change again before long",
        "ad7340c0d2664b131f969961d78c86b2 (23:22): true",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:23): whether you temporarily support the other work-in-progress implementations is up to you",
        "ad7340c0d2664b131f969961d78c86b2 (23:23): hmm.. I could add a useStrict  flag in the options for the server as to whether to reject or allow clients not sending Sec-*",
        "ad7340c0d2664b131f969961d78c86b2 (23:24): hmm.. to bed: it's 6:22am..",
        "71bd9426656c7068876f52fb7934af7f (23:26): ad7340c0d2664b131f969961d78c86b2, goodnight"
    ],
    "person_ids": [
        "ad7340c0d2664b131f969961d78c86b2",
        "b25b6b77a0087ff8385941e5545d32ea",
        "71bd9426656c7068876f52fb7934af7f",
        "3501532e992dae83a8bc6c811325317e",
        "69b0d3dfe919a6b860a9fac82de52a7e",
        "a924fb58d2c25874322f4e5126f608b9"
    ]
}