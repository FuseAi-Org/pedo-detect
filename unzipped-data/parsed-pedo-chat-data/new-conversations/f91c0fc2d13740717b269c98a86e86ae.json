{
    "id": "f91c0fc2d13740717b269c98a86e86ae",
    "messages": [
        "8fdfd46100cea24fdcedfd902144aa07 (22:08): omgs, I figured out what the problem with that one was, the group which all the machines belonged to changed :)",
        "8fdfd46100cea24fdcedfd902144aa07 (22:09): now I have another problem, when I try to rejoin a computer to the domain / join a new one, I get an error that the computer can't join the domain. Any ideas on that one? :D",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:31): Aquatopia: do you have a custom script or setting for adding machines?",
        "8fdfd46100cea24fdcedfd902144aa07 (22:31): omgs: no, the machine already exists, and I've tried removing it, using a add machine scripts, etc",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:32): If not, try &quot;getent passwd computer$&quot; replacing &quot;computer$&quot; with the computer you're trying to add",
        "8fdfd46100cea24fdcedfd902144aa07 (22:32): the error message is something in the direction of: Either the given domain name can't be found or it cannot be accessed.. (in danish), the machine pings fine, there is no firewall, nothing blocking, etc",
        "8fdfd46100cea24fdcedfd902144aa07 (22:33): gudmundur$:x:578:111::/dev/null:/bin/false",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:33): If it returns empty, then you don't have the account",
        "8fdfd46100cea24fdcedfd902144aa07 (22:33): it returned that",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:34): Rewrite the root (or admin) passwd with smbpasswd root (or the admin)",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:34): What backend are you using?",
        "8fdfd46100cea24fdcedfd902144aa07 (22:34): default backend",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:35): How many computers do you intend to manage?",
        "8fdfd46100cea24fdcedfd902144aa07 (22:35): ~25",
        "8fdfd46100cea24fdcedfd902144aa07 (22:36): I will be switching over to ldap soon, but that is not a possibility right at this moment :9",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:36): &quot;default&quot; is ambiguous. I suggest to use tdbsam (if ldap is too much for you)",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:36): Also, try &quot;pdbedit -Lv gudmundur$&quot;",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:37): And of course, samba logs",
        "8fdfd46100cea24fdcedfd902144aa07 (22:37): pdbedit shows me some stuff...",
        "8fdfd46100cea24fdcedfd902144aa07 (22:38): yeah, the samba logs, which files should I be looking at",
        "8fdfd46100cea24fdcedfd902144aa07 (22:38): cos there is relatively much traffic in them :D",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:38): something related to the user, .log or the machine/ip (depending on your log setting)",
        "8fdfd46100cea24fdcedfd902144aa07 (22:39): that didn't show alot",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:41): What user are you using to add machines (in the computer)?",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:42): Are you sure it exists and has administrative rights?",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:43): Also, check the samba password of that user",
        "8fdfd46100cea24fdcedfd902144aa07 (22:43): I'm trying to use root for that",
        "8fdfd46100cea24fdcedfd902144aa07 (22:44): no change if I change the password for root in smbpasswd",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:44): You didn't reply accurately to the backend question",
        "8fdfd46100cea24fdcedfd902144aa07 (22:44): yeah, the &quot;default&quot; one debian uses :d",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:44): Aquatopia: that's not an accurate reply",
        "8fdfd46100cea24fdcedfd902144aa07 (22:45): omgs: I think it is smbpasswd",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:45): testparm|grep backend",
        "8fdfd46100cea24fdcedfd902144aa07 (22:45): doesn't show anything",
        "8fdfd46100cea24fdcedfd902144aa07 (22:45): it's not specified in the smb.conf",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:45): testparm -v|grep backend",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:47): Do you have many users/passwords at this time?",
        "8fdfd46100cea24fdcedfd902144aa07 (22:47): smbpasswd",
        "8fdfd46100cea24fdcedfd902144aa07 (22:47): ~25 :)",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:48): Well, I suggest to export to tdbsam. Let me take a look at pdbedit for the exact syntax",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:49): Well, first backup your smbpasswd file :)",
        "8fdfd46100cea24fdcedfd902144aa07 (22:50): hehe :D done and done",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:50): Then, &quot;pdbedit -b tdbsam -L&quot; to see what's there (should be nothing)",
        "8fdfd46100cea24fdcedfd902144aa07 (22:50): only shows the default accounts on the computer when I installed debian",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:51): According to what you say, it's unused (not to mention that you are NOT using debian default)",
        "8fdfd46100cea24fdcedfd902144aa07 (22:52): well, if I run pdbedit -b smbpasswd -L I get all the users registered",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:52): To export, try &quot;pdbedit -e tdbsam&quot;",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:53): Then, check with &quot;pdbedit -b tdbsam -L&quot; again",
        "8fdfd46100cea24fdcedfd902144aa07 (22:53): Unable to modify passwd TDB! Error: Record exists occured while storing the main record (USER_root)",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:54): well, you have to delete existing accounts in tdbsam",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:54): You can do one by one with &quot;pdbedit -b tdbsam -x user&quot;",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:55): Also, you can try (I'm not sure about this) to delete the tdbsam file at /var/lib/samba or similar",
        "8fdfd46100cea24fdcedfd902144aa07 (22:55): well, now it has all the users / machines",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:56): Well, try adding &quot;passdb backend = tdbsam&quot; in smb.conf and restart samba",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:57): For your info, you can always come back to smbpasswd (I hope not)",
        "8fdfd46100cea24fdcedfd902144aa07 (22:57): no success :S",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:58): Why? give more info, please",
        "8fdfd46100cea24fdcedfd902144aa07 (22:58): all the computers can access the server, log onto it, get files, etc... but computers that I'm trying to join to the domain or rejoin the domain can't",
        "8fdfd46100cea24fdcedfd902144aa07 (22:58): that's the problem",
        "8fdfd46100cea24fdcedfd902144aa07 (22:59): if I try: \\\\servername\\gudmundur that works fine",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:59): Did you do &quot;smbpasswd -a -m machine&quot;?",
        "8b2228cfb74d8c1ec240f8271acd5373 (22:59): Without trailing &quot;$&quot;",
        "8fdfd46100cea24fdcedfd902144aa07 (22:59): not without the trailing $ n",
        "8fdfd46100cea24fdcedfd902144aa07 (22:59): no",
        "8fdfd46100cea24fdcedfd902144aa07 (23:00): it has worked up till now with the $",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:03): mmm I might be wrong, but with &quot;pdbedit -Lv computer$&quot;, you should see &quot;[W]&quot; in account flags",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:04): Also, with &quot;pdbedit -Lv root&quot;, check that the primary sid ends in -500&quot;",
        "8fdfd46100cea24fdcedfd902144aa07 (23:05): accounts flags: contains w",
        "8fdfd46100cea24fdcedfd902144aa07 (23:05): Primary Group SID:    S-1-5-21-1358197688-1829595849-908712776-1001",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:05): Try, when adding the computer, to supply a wrong pass for root, and see if the result is the same",
        "8fdfd46100cea24fdcedfd902144aa07 (23:05): yeah, it gives the same result",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:06): I meant the &quot;User SID&quot;, not the group SID",
        "8fdfd46100cea24fdcedfd902144aa07 (23:06): User SID:             S-1-5-21-1358197688-1829595849-908712776-1000",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:06): That's a plain user, with no admin rights (at a first glance)",
        "8fdfd46100cea24fdcedfd902144aa07 (23:07): ok, how do i add root with admin rights then?",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:07): The sid should be something like the domain sid and &quot;-500&quot;",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:08): The domain sid is &quot;net getlocalsid&quot;",
        "8318757b6ba7d448fa6a59223f287991 (23:08): quick question: smbfs or cifs?",
        "8318757b6ba7d448fa6a59223f287991 (23:09): using Kubuntu Dapper",
        "8318757b6ba7d448fa6a59223f287991 (23:09): mount.cifs version: 1.10",
        "8318757b6ba7d448fa6a59223f287991 (23:10): mount.smbfs: Version 3.0.22",
        "8fdfd46100cea24fdcedfd902144aa07 (23:10): omgs, hmm, having troubles changing it :D",
        "8fdfd46100cea24fdcedfd902144aa07 (23:13): ok, figured that out",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:13): You should see the groups with &quot;net groupmap list&quot;",
        "8fdfd46100cea24fdcedfd902144aa07 (23:13): but still, like you asked before, I tried giving the wrong password when trying to join the domain, and I get precisely the same error",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:15): Did you specifiy root to be admin in smb.conf?",
        "8fdfd46100cea24fdcedfd902144aa07 (23:15): [2006/06/03 20:14:06, 0] utils/net_ads.c:ads_startup(191)",
        "8fdfd46100cea24fdcedfd902144aa07 (23:15): ads_connect: Transport endpoint is not connected",
        "8fdfd46100cea24fdcedfd902144aa07 (23:15): &lt;- could this be something",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:15): ads?",
        "8fdfd46100cea24fdcedfd902144aa07 (23:15): no idea",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:15): What security are you using?",
        "8fdfd46100cea24fdcedfd902144aa07 (23:15): user",
        "8fdfd46100cea24fdcedfd902144aa07 (23:16): it's not implicitly said it's root anywhere in smb.conf no",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:16): Try adding &quot;admin users = root&quot; in smb.conf",
        "8fdfd46100cea24fdcedfd902144aa07 (23:18): hate to say this, same thing :D",
        "8fdfd46100cea24fdcedfd902144aa07 (23:18): shouldn't I be able to see in some log file what the error is?",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:18): Check the samba logs root.log, or latest .log files",
        "8b2228cfb74d8c1ec240f8271acd5373 (23:20): Also, use just &quot;testparm&quot; to see if you have something strange",
        "8fdfd46100cea24fdcedfd902144aa07 (23:25): can't see anything awfully broken :P",
        "8fdfd46100cea24fdcedfd902144aa07 (23:26): well, I really have to go now :S so, work for me tomorrow aswell :D",
        "8fdfd46100cea24fdcedfd902144aa07 (23:28): thanks alot for the help... I'll hopefully figure this out tomorrow otherwise people are gonna be a bit mad when the get to work on monday :D",
        "8fdfd46100cea24fdcedfd902144aa07 (23:28): bye"
    ],
    "person_ids": [
        "8fdfd46100cea24fdcedfd902144aa07",
        "8b2228cfb74d8c1ec240f8271acd5373",
        "8318757b6ba7d448fa6a59223f287991"
    ]
}