{
    "id": "ce035b7f8bafcd4815b05cd63f97dd2a",
    "messages": [
        "93dede99112199d049a1bc421e564cd4 (08:33): insta: try adding some logging rules before your INPUT DROP and see if anything obvious arises from that",
        "6cdbd7d5cc6588a2bdb0e64c5cd7dbb2 (08:36): vice-versa: Something like iptables -A INPUT -j LOG ?",
        "93dede99112199d049a1bc421e564cd4 (08:36): yes",
        "6cdbd7d5cc6588a2bdb0e64c5cd7dbb2 (08:37): ... where does this log to?",
        "93dede99112199d049a1bc421e564cd4 (08:38): system logger kernel messages",
        "5f05b3ded4139f6a691da91429a957b9 (08:39): insta: I haven't looked at your ruleset, but unless you've got the NFS daemons boud to specific ports, *or* you've got someting in userspace to parse rpcinfo -p output after starting the NFS server, and that something alters iptables rules, then nfs is going to be problematic",
        "5f05b3ded4139f6a691da91429a957b9 (08:40): RPC uses random (more or less) port assignments, so they won't be consistent between NFS restarts / server reboots",
        "5f05b3ded4139f6a691da91429a957b9 (08:40): If that's your problem, you might find this useful: <a href=\"http://howtos.rlworkman.net/NFS_Firewall_HOWTO\">http://howtos.rlworkman.net/NFS_Firewall_HOWTO</a>",
        "de76c8e6cbbc3c1c44788a340cac141e (08:42): maxine: NFS uses RPC to find its ports, which are dynamic on each NFS server resart. See <a href=\"http://howtos.rlworkman.net/NFS_Firewall_HOWTO\">http://howtos.rlworkman.net/NFS_Firewall_HOWTO</a>",
        "d949efae795da71ef603b60b018d191c (08:42): OK, danieldg.",
        "de76c8e6cbbc3c1c44788a340cac141e (08:42): oops...",
        "de76c8e6cbbc3c1c44788a340cac141e (08:44): maxine: nfs",
        "d949efae795da71ef603b60b018d191c (08:45): NFS uses RPC to find its ports, which are dynamic on each NFS server resart. See <a href=\"http://howtos.rlworkman.net/NFS_Firewall_HOWTO\">http://howtos.rlworkman.net/NFS_Firewall_HOWTO</a> to make it bind to specific ports",
        "5f05b3ded4139f6a691da91429a957b9 (08:45): danieldg: thanks :)",
        "6cdbd7d5cc6588a2bdb0e64c5cd7dbb2 (08:45): Well, the ruleset that I have should be pretty simple, as far as I can tell",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:46): im trying to execute my iptables script everytime i get this # ./iptables_script",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:46): iptables: No chain/target/match by that name   im not sure how or why i get it. but it casues all my ports to close up. i have a cronjob that runs every 5 minutes that opens the ports so im able ot get back in but i dont understand why i cant execute this?",
        "de76c8e6cbbc3c1c44788a340cac141e (08:47): figure out which command makes that error",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:49): my script is very basic i dont see what could be wrong with it  <a href=\"http://mrsako.pastebin.ca/111065\">http://mrsako.pastebin.ca/111065</a>",
        "de76c8e6cbbc3c1c44788a340cac141e (08:49): it's likely the problem is in your kernel",
        "de76c8e6cbbc3c1c44788a340cac141e (08:50): does dmesg have any information that looks related?",
        "5f05b3ded4139f6a691da91429a957b9 (08:50): -p TCP should be -p tcp",
        "5f05b3ded4139f6a691da91429a957b9 (08:50): (in the last line)",
        "5f05b3ded4139f6a691da91429a957b9 (08:50): and you need to uncomment your EST/REL line",
        "de76c8e6cbbc3c1c44788a340cac141e (08:51): what kernel? can you load the ipt_state module?",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:52): ive been having issues with using rules that involve states in it im gonna uncomment that line",
        "5f05b3ded4139f6a691da91429a957b9 (08:52): MrSako: unless you fix this line:  $IPT -A INPUT -p TCP -m multiport --dports \\",
        "5f05b3ded4139f6a691da91429a957b9 (08:52): It won't matter - change that TCP to tcp",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:52): so just the tcp should be lowercase",
        "5f05b3ded4139f6a691da91429a957b9 (08:52): Yes",
        "5f05b3ded4139f6a691da91429a957b9 (08:53): You might have *two* problems - but that's definitely *one* of them",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:53): i just executed again and got the same thing",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:53): oh should i take our the --state NEW part",
        "5f05b3ded4139f6a691da91429a957b9 (08:54): oh, yes",
        "5f05b3ded4139f6a691da91429a957b9 (08:54): I missed that",
        "5f05b3ded4139f6a691da91429a957b9 (08:54): If you want to check for state, you need -m state in there",
        "5f05b3ded4139f6a691da91429a957b9 (08:55): Wait, ignore that - it's there",
        "5f05b3ded4139f6a691da91429a957b9 (08:55): :/",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:55): well i think theres somethnig wrong with my kernel or some module or osmething for using states imj ust gonna take all states out for now",
        "5f05b3ded4139f6a691da91429a957b9 (08:57): <a href=\"http://mrsako.pastebin.ca/111069\">http://mrsako.pastebin.ca/111069</a>  &lt;-- should work.  If not, I'm definitely with danieldg on looking at the kernel config",
        "5f05b3ded4139f6a691da91429a957b9 (08:57): danieldg: btw, I'll edit that document to reflect the fact that it's written for Slackware, but the general idea is the same across distros",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:57): hold on: i just got the script to execute, i took out everything about the state out",
        "5f05b3ded4139f6a691da91429a957b9 (08:58): yep, kernel config",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:58): so its something wrong with the kernel itself",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:58): what kind of stuff would i have ot look into to fix it",
        "de76c8e6cbbc3c1c44788a340cac141e (08:58): do you have the .config file for the kernel?",
        "81c9aeea32beb1a1db26e1b2ad30133c (08:59): where is it located?",
        "de76c8e6cbbc3c1c44788a340cac141e (08:59): mine are all in /boot/config-`uname -r`",
        "de76c8e6cbbc3c1c44788a340cac141e (08:59): or try /proc/config.gz",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:00): i just did this thing on with this javaappplet that comes with webmin to search the computer, theres no files named config.gz or .config",
        "5f05b3ded4139f6a691da91429a957b9 (09:00): MrSako: what distro?",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:00): CentOS 4.2",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:00): this is a VPS im renting it could be a setup error by the hosters",
        "5f05b3ded4139f6a691da91429a957b9 (09:00): er, guh",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:01): is guh bad?",
        "5f05b3ded4139f6a691da91429a957b9 (09:01): hehe, that was supposed to be &quot;ugh&quot;",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:01): oh gotcha :)",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:02): i think im going to submit a support ticket to my VPS host",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:02): what do you think would be a good thing to type",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:02): im looking for my .config file and i cant find it?",
        "de76c8e6cbbc3c1c44788a340cac141e (09:03): I don't think .config is the official name... kernel configuration might be better",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:05): kernel configuration file",
        "93dede99112199d049a1bc421e564cd4 (09:13): MrSako: CentOS is a forked from RHEL iirc, try   ls -l /boot/config-`uname -r`&amp;&amp;grep STATE /boot/config-`uname -r`",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:13): type that in?",
        "93dede99112199d049a1bc421e564cd4 (09:13): ya",
        "de76c8e6cbbc3c1c44788a340cac141e (09:15): if that works, also grep for CONNTRACK",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:15): my /boot directory is completely empty",
        "93dede99112199d049a1bc421e564cd4 (09:16): unmounted perhaps?",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:16): i woudlnt know",
        "93dede99112199d049a1bc421e564cd4 (09:16): mount /boot",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:17): i just typed grep CONNTRACK so i think its spending along time to grep through my machine can i stop it somehow?",
        "de76c8e6cbbc3c1c44788a340cac141e (09:17): ctrl-C",
        "de76c8e6cbbc3c1c44788a340cac141e (09:17): it's grepping your input",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:18): # mount /boot",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:18): mount: can't find /boot in /etc/fstab or /etc/mtab",
        "de76c8e6cbbc3c1c44788a340cac141e (09:18): vice-versa: it's a VPS, so I don't think there is a /boot that can be mounted",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:18): yeh i forgot to mention that",
        "93dede99112199d049a1bc421e564cd4 (09:18): aye, srry missed that",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:20): whats the correct grep syntax to find a file?",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:20): like im looking for a file named blah under a certain directory",
        "de76c8e6cbbc3c1c44788a340cac141e (09:21): you'd use `find` for that",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:21): oh",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:21): greps for finding text in a file",
        "de76c8e6cbbc3c1c44788a340cac141e (09:21): find / -iname '*config*'",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:28): do you think that the connection state commands wont execute becasue im missnig the conntrack file?",
        "de76c8e6cbbc3c1c44788a340cac141e (09:29): not the file itself, but the kernel module that creates it (which keeps track of the states)",
        "de76c8e6cbbc3c1c44788a340cac141e (09:29): the files in /proc aren't files",
        "93dede99112199d049a1bc421e564cd4 (09:39): MrSako: what kernel is the vps using?",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:39): how do i check the kernel version?",
        "93dede99112199d049a1bc421e564cd4 (09:39): uname -r",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:40): 2.6.8-022stab070.9-smp",
        "93dede99112199d049a1bc421e564cd4 (09:44): MrSako: does  lsmod  show ipt_state ?",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:44): lsmod doesnt return anything",
        "93dede99112199d049a1bc421e564cd4 (09:46): must be another vps exclusion perhaps, dunno never used one",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:48): what does lsmod supposed to do?",
        "93dede99112199d049a1bc421e564cd4 (09:49): lists kernel modules",
        "93dede99112199d049a1bc421e564cd4 (09:51): does a vps have a proc fs?",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:54): vice-versa: you mean the command proc fs? if so no",
        "93dede99112199d049a1bc421e564cd4 (09:54): no, ls -ld /proc",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:55): [root@vps boot]# ls -ld /proc",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:55): dr-xr-xr-x  805 root root 0 Jul 31 15:37 /proc",
        "93dede99112199d049a1bc421e564cd4 (09:56): I'm guessing it does, albeit a virtual one",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:56): is that whats causing the problem perhaps?",
        "93dede99112199d049a1bc421e564cd4 (09:56): no",
        "93dede99112199d049a1bc421e564cd4 (09:56): cat /proc/modules",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:57): vice-versa: returns nothing",
        "93dede99112199d049a1bc421e564cd4 (09:57): figured it would",
        "93dede99112199d049a1bc421e564cd4 (09:58): MrSako: iptables -h -m state",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:59): it gives me all this stuff about how to use the command iptables",
        "81c9aeea32beb1a1db26e1b2ad30133c (09:59): its iptables v1.2.11 if that means anything",
        "93dede99112199d049a1bc421e564cd4 (10:01): mmm, yeah doesn't do what I thought"
    ],
    "person_ids": [
        "93dede99112199d049a1bc421e564cd4",
        "6cdbd7d5cc6588a2bdb0e64c5cd7dbb2",
        "5f05b3ded4139f6a691da91429a957b9",
        "de76c8e6cbbc3c1c44788a340cac141e",
        "d949efae795da71ef603b60b018d191c",
        "81c9aeea32beb1a1db26e1b2ad30133c"
    ]
}