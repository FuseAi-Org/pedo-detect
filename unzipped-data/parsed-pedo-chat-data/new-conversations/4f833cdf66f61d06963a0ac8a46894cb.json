{
    "id": "4f833cdf66f61d06963a0ac8a46894cb",
    "messages": [
        "1651912376f152bc027afcbf48a0a276 (22:46): is the client required to send a UserAgent string when establishing a websocket connection?",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:46): when i was writing the spec, it was required not to",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:47): no idea what the spec says now though",
        "1651912376f152bc027afcbf48a0a276 (22:47): why not to?",
        "1651912376f152bc027afcbf48a0a276 (22:47): if you only send it once, why not send it?",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:47): because it hurts small browsers",
        "1651912376f152bc027afcbf48a0a276 (22:48): firefox sends the UseAgent while chrome doesn't",
        "1651912376f152bc027afcbf48a0a276 (22:48): so if I need the user agent, I should send it myself after the connection?",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:48): you should not need the user agent",
        "1651912376f152bc027afcbf48a0a276 (22:49): if there is a bug, I want to know what browser cause it",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:49): is there a bug?",
        "1651912376f152bc027afcbf48a0a276 (22:49): there are always bugs",
        "1651912376f152bc027afcbf48a0a276 (22:50): not with the websocket implementation but anything",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:50): then file the bug with the browser vendor and have them fix it",
        "1651912376f152bc027afcbf48a0a276 (22:50): :)",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:50): working around the bug will just make matters worse",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:50): on the long run",
        "1651912376f152bc027afcbf48a0a276 (22:50): that's not what I meant",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:51): but it's what i meant :-)",
        "1651912376f152bc027afcbf48a0a276 (22:51): I want to have statistics about my users, to know what browsers they use",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:51): why?",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:51): it shouldn't make any difference to you",
        "1651912376f152bc027afcbf48a0a276 (22:51): are you serious?",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:51): yes",
        "1651912376f152bc027afcbf48a0a276 (22:51): all browsers work 100% ?",
        "1651912376f152bc027afcbf48a0a276 (22:51): no bugs? no missing features?",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:52): missing features you can feature-test for, you don't need to know which browser it is",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:52): bugs, you should ignore, and let the browser vendors fix it, instead of hacking around them",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:52): certainly shouldn't sniff for the browser to work around them",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:52): if you do that you will make it harder for them to fix the bug",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:52): not to mention that it means you are prioritising certain browsers over others",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:53): which gives smaller browsers a competitive disadvantage",
        "1651912376f152bc027afcbf48a0a276 (22:53): I don't care about politics",
        "1651912376f152bc027afcbf48a0a276 (22:53): I want my app to work",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:54): this isn't politics, it's the good of the human race",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:54): anyway, we're talking about hypotheticals here",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:54): it's easier to discuss concrete cases",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:55): hence my question:",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:55): is there a bug?",
        "1651912376f152bc027afcbf48a0a276 (22:55): so if a plane crash, the model is not important",
        "1651912376f152bc027afcbf48a0a276 (22:55): just let the company fix it",
        "1651912376f152bc027afcbf48a0a276 (22:55): they should guess it happened",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:55): if you're building a plane on WebSocket then you need your head examined :-)",
        "6b57ea7f33069df5914663ba9e59afdf (22:55): :)",
        "1651912376f152bc027afcbf48a0a276 (22:56): no, I'm building a web app and I put most of my time making it compatible with opera",
        "da5121879fff54b08b69ec54d9ac2bf6 (22:56): Which of our many bugs are causing you trouble?",
        "1651912376f152bc027afcbf48a0a276 (22:56): because most of the users in the world use it",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:56): 1651912376f152bc027afcbf48a0a276: you shouldn't put your time into making your web app compatible with _any_ browser",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:56): 1651912376f152bc027afcbf48a0a276: write to the spec, and if the browsers are buggy, file bugs with the browsers",
        "1651912376f152bc027afcbf48a0a276 (22:58): that's exactly how gmail work",
        "69b0d3dfe919a6b860a9fac82de52a7e (22:58): i would definitely not recommend taking gmail as an example for how to build a web app",
        "1651912376f152bc027afcbf48a0a276 (22:58): they implemented the chat and video with html5 5 years ago",
        "1651912376f152bc027afcbf48a0a276 (23:03): should the browser show a warning when using secure websocket with self signed certificate?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:03): no, it should just disallow it from connecting",
        "1651912376f152bc027afcbf48a0a276 (23:04): but browsers allow pages of self signed certificates with a warning",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:05): yeah, that's dubious too. but at least they can put up an interstitial to explain to the user that they're about to have their identity stolen.",
        "1651912376f152bc027afcbf48a0a276 (23:06): about feature detection, can I detect the websocket version on the client?",
        "1651912376f152bc027afcbf48a0a276 (23:06): I know I can see the version on the server",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:07): aw man, did they add a version to the protocol?",
        "1651912376f152bc027afcbf48a0a276 (23:07): ?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:07): back when i was editing the spec, the protocol was not versioned",
        "1651912376f152bc027afcbf48a0a276 (23:07): why not?",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:07): because versioning on the web is even worse than user agent sniffing",
        "1651912376f152bc027afcbf48a0a276 (23:08): wow.",
        "1651912376f152bc027afcbf48a0a276 (23:08): this is a lost cause :)",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:08): versioning is unnecessary on the web",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:08): html, css, js... they all work fine without versioning",
        "8b3687499080633e1898fa1dd209ef81 (23:10): Why did we implement the stupid version of websockets again?",
        "ab7faae5d7b250ea8606486575f8f79c (23:10): Version numbers are useful when you spend two years tweaking fundamental aspects of the protocol and make everyone end up implementing different revisions of the specification",
        "69b0d3dfe919a6b860a9fac82de52a7e (23:12): ab7faae5d7b250ea8606486575f8f79c: yeah, don't do that :-P",
        "1651912376f152bc027afcbf48a0a276 (23:13): ab7faae5d7b250ea8606486575f8f79c: thank you",
        "ab7faae5d7b250ea8606486575f8f79c (23:13): Not everyone has enough self-control to avoid doing that :-)",
        "b9acb5df457f56156060d93d0827b8ac (23:24): I believe websokets tells you the version number in the header, doesn't it?",
        "1651912376f152bc027afcbf48a0a276 (23:25): yes but the client doesn't know its version",
        "b9acb5df457f56156060d93d0827b8ac (23:26): ?",
        "b25b6b77a0087ff8385941e5545d32ea (23:27): Anyway ignore all versions that aren't -17",
        "b25b6b77a0087ff8385941e5545d32ea (23:27): I imagine everyone will fix their implementations to the RFC soon enough",
        "b25b6b77a0087ff8385941e5545d32ea (23:28): (I think -17 is indicated by 13 in the version field or something stupid)",
        "b25b6b77a0087ff8385941e5545d32ea (23:28): (yeah it is)",
        "b25b6b77a0087ff8385941e5545d32ea (23:29): Anyway, I can't work out why you care about the protocol version on the client",
        "b25b6b77a0087ff8385941e5545d32ea (23:30): I mean obviously if you *do* care it is trivial to find out, assuming you control oth ends of the wire; just send it as part of your subprotocol e.g. in the first message",
        "1651912376f152bc027afcbf48a0a276 (23:32): b25b6b77a0087ff8385941e5545d32ea: but if the client doesn't support the required version, why send the first request anyway?",
        "1651912376f152bc027afcbf48a0a276 (23:32): than you should use long-polling or something else instead",
        "b25b6b77a0087ff8385941e5545d32ea (23:33): I don't understand what situation you are worried about",
        "1651912376f152bc027afcbf48a0a276 (23:33): a situation where the client has websockets but not the required version",
        "1651912376f152bc027afcbf48a0a276 (23:34): how come ab7faae5d7b250ea8606486575f8f79c understood me and you and 69b0d3dfe919a6b860a9fac82de52a7e don't?",
        "b25b6b77a0087ff8385941e5545d32ea (23:34): What case is there where you are able to establish a websocket connection, but you can't actually use that connection?",
        "1651912376f152bc027afcbf48a0a276 (23:34): why should you try to establish a connection if it's won't work?",
        "1651912376f152bc027afcbf48a0a276 (23:35): I forgot",
        "b25b6b77a0087ff8385941e5545d32ea (23:35): It seems like a reasonably good way of telling that it won't work",
        "1651912376f152bc027afcbf48a0a276 (23:35): yes",
        "1651912376f152bc027afcbf48a0a276 (23:35): do I have air bag in this car?",
        "1651912376f152bc027afcbf48a0a276 (23:35): wait, just crash against the wall",
        "1651912376f152bc027afcbf48a0a276 (23:35): no, I don't",
        "1651912376f152bc027afcbf48a0a276 (23:35): are you serious?",
        "1651912376f152bc027afcbf48a0a276 (23:36): are you the guys that writing the specs?",
        "1651912376f152bc027afcbf48a0a276 (23:36): that's scary :)",
        "b25b6b77a0087ff8385941e5545d32ea (23:37): I am rally trying to be helpful here...",
        "b25b6b77a0087ff8385941e5545d32ea (23:37): *really",
        "b25b6b77a0087ff8385941e5545d32ea (23:37): What is the concrete problem you are trying to solve?",
        "b25b6b77a0087ff8385941e5545d32ea (23:38): Is it &quot;I need to work with outdated versions of chrome&quot;?",
        "b25b6b77a0087ff8385941e5545d32ea (23:38): (and safari, maybe? I don't know if they shipped the insecure stuff too)",
        "1651912376f152bc027afcbf48a0a276 (23:38): I shouldn't try to connect with the client if the websocket on it are &quot;broken&quot;",
        "1651912376f152bc027afcbf48a0a276 (23:38): or with an old version",
        "1651912376f152bc027afcbf48a0a276 (23:38): what's complicated about it?",
        "b25b6b77a0087ff8385941e5545d32ea (23:38): No, that's not a problem",
        "1651912376f152bc027afcbf48a0a276 (23:39): how come it's not a problem?",
        "b25b6b77a0087ff8385941e5545d32ea (23:39): That's a statement of something you want, but you didn't explain why you want that beyond some irrelevent metaphor about safety critical systems like airbags",
        "1651912376f152bc027afcbf48a0a276 (23:39): because it's stupid to first try to use websocket and than if it fails use long-polling",
        "1651912376f152bc027afcbf48a0a276 (23:39): you are wasting requests",
        "1651912376f152bc027afcbf48a0a276 (23:40): and the connection takes more time",
        "1651912376f152bc027afcbf48a0a276 (23:40): so the user experience your client have is bad",
        "1651912376f152bc027afcbf48a0a276 (23:40): do you understand this?",
        "1651912376f152bc027afcbf48a0a276 (23:40): or maybe not?",
        "b25b6b77a0087ff8385941e5545d32ea (23:40): Yes, but on the other hand it will also cover situations where websockets fail for some other reason e.g. due o special proxies or firewalls or wahtever",
        "1651912376f152bc027afcbf48a0a276 (23:41): those are two different cases",
        "b25b6b77a0087ff8385941e5545d32ea (23:41): I agree that the latency could be a problem for some aplications. Is your application hihly sensitive to the initial latency?",
        "1651912376f152bc027afcbf48a0a276 (23:41): not it's not",
        "1651912376f152bc027afcbf48a0a276 (23:41): my users like to wait",
        "1651912376f152bc027afcbf48a0a276 (23:42): it's a website for s&amp;m so they like to suffer",
        "ab7faae5d7b250ea8606486575f8f79c (23:42): 1651912376f152bc027afcbf48a0a276: I wasn't trying to agree with you, I was just trying to be unhelpfully snarky about the IETF",
        "1651912376f152bc027afcbf48a0a276 (23:42): ok",
        "b25b6b77a0087ff8385941e5545d32ea (23:42): Well with my approach you can cover them with one codepath for the short-term need (old versions of frequently updated browsers) and the long term case (intermediaries that block websockets)",
        "b25b6b77a0087ff8385941e5545d32ea (23:43): 1651912376f152bc027afcbf48a0a276: It is entirely non-obvious that your particular use of websockets depends on being able to establish a connection wih minimum latency",
        "1651912376f152bc027afcbf48a0a276 (23:44): forget it",
        "1651912376f152bc027afcbf48a0a276 (23:44): this idiotic discussion is a waste of time",
        "b25b6b77a0087ff8385941e5545d32ea (23:44): Consider something where the page loads and then one has to have user interaction before establishing the real conenction",
        "b25b6b77a0087ff8385941e5545d32ea (23:45): The time for the user to interact with the page is going to be way longer than the time to set up a connection, so you can create a trial connection during page load",
        "b25b6b77a0087ff8385941e5545d32ea (23:45): and then already know if it will work when the actual connection is needed",
        "b25b6b77a0087ff8385941e5545d32ea (23:47): OTOH if you are trying to build a search engine that pulls the results over websokets than that delay might be undesirable (although I note that you will get it in the &quot;broken intermediary&quot; case anyway, and that in the other case it will only persist until browsers fix their implemenations to the latest spec)",
        "b25b6b77a0087ff8385941e5545d32ea (23:48): (for that example I assume that the search engine tries to pull the results on page load)",
        "b25b6b77a0087ff8385941e5545d32ea (23:51): (oh it seems that gecko haven't updated to -17 yet but chrome has. Still I guess the server should support both)",
        "b25b6b77a0087ff8385941e5545d32ea (23:51): (bth -10 and -17 that is)",
        "b25b6b77a0087ff8385941e5545d32ea (23:51): 1651912376f152bc027afcbf48a0a276: I am sorry you think it has been a waste of time. I have really tried to help you solve your problem. I'm sorry if my suggestions didn't match the solution you had in mind."
    ],
    "person_ids": [
        "1651912376f152bc027afcbf48a0a276",
        "69b0d3dfe919a6b860a9fac82de52a7e",
        "6b57ea7f33069df5914663ba9e59afdf",
        "da5121879fff54b08b69ec54d9ac2bf6",
        "8b3687499080633e1898fa1dd209ef81",
        "ab7faae5d7b250ea8606486575f8f79c",
        "b9acb5df457f56156060d93d0827b8ac",
        "b25b6b77a0087ff8385941e5545d32ea"
    ]
}