{
    "id": "48901b5099620c0e19dd637c200707d3",
    "messages": [
        "d69dc8c061f6093da232e19c85e6b5f2 (09:55): now we are getting somewhere",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:01): arty: ping",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:17): hmm",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:18): suspicious MultiByteToWideChar",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:18): everything goes awry from there.",
        "2741b69c3b371bf320f870bfe5de76c7 (10:23): hey",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:25): <a href=\"http://rafb.net/paste/results/1ZjYVv65.html\">http://rafb.net/paste/results/1ZjYVv65.html</a>",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:26): MultiByteToWideChar with only one argument?",
        "2741b69c3b371bf320f870bfe5de76c7 (10:26): hmm wow",
        "2741b69c3b371bf320f870bfe5de76c7 (10:26): looks suspicious",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:26): well, everything falls down after that.",
        "2741b69c3b371bf320f870bfe5de76c7 (10:27): i don't doubt it :-)",
        "2741b69c3b371bf320f870bfe5de76c7 (10:27): where is that?",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:27): tools/mkhive/registry.c",
        "2741b69c3b371bf320f870bfe5de76c7 (10:28): it's a different multibytetowidechar",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:28): I don't think it's doing the right thing.",
        "2741b69c3b371bf320f870bfe5de76c7 (10:28): a leaky one :-)",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:28): ;0)",
        "2741b69c3b371bf320f870bfe5de76c7 (10:29): ya i really think this only works by accident if it does",
        "2741b69c3b371bf320f870bfe5de76c7 (10:29): i'll fix it",
        "e616a5c411ef7b6ec895672e618d41ba (10:29): maybe it has bullet holes in it :P",
        "2741b69c3b371bf320f870bfe5de76c7 (10:30): ahh i see",
        "a8ca23b1263a67497231334ce320bb64 (10:34): Some creative Secuirty crash causes. Being removed.",
        "a8ca23b1263a67497231334ce320bb64 (10:34): Nice",
        "2741b69c3b371bf320f870bfe5de76c7 (10:36): some of us seem to assume that UNICODE_STRING.Buffer is null terminated",
        "2741b69c3b371bf320f870bfe5de76c7 (10:37): casper used to do that a lot",
        "a8ca23b1263a67497231334ce320bb64 (10:37): Ok what is a UNICODE_STRING ment to be terminated with.",
        "a8ca23b1263a67497231334ce320bb64 (10:38): Ok that is just nasty.  The Null is optional.",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:39): That's what UNICODE_STRING.Length is for. ;)",
        "a8ca23b1263a67497231334ce320bb64 (10:39): The point I class as nasty is you are allowed to Null terminate if you wish.",
        "2741b69c3b371bf320f870bfe5de76c7 (10:41): hmm here's another bug",
        "2741b69c3b371bf320f870bfe5de76c7 (10:51): <a href=\"http://www.superheterodyne.net/reactos/registry.diff\">http://www.superheterodyne.net/reactos/registry.diff</a>",
        "2741b69c3b371bf320f870bfe5de76c7 (10:51): try this",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:53): RegSetValueA()",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:53): *** glibc detected *** double free or corruption (!prev): 0x0805f888 ***",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:53): Aborted",
        "2741b69c3b371bf320f870bfe5de76c7 (10:53): hmm",
        "d69dc8c061f6093da232e19c85e6b5f2 (10:56): <a href=\"http://rafb.net/paste/results/rNK0u398.html\">http://rafb.net/paste/results/rNK0u398.html</a>",
        "2741b69c3b371bf320f870bfe5de76c7 (10:56): hold on a sec",
        "2741b69c3b371bf320f870bfe5de76c7 (11:03): oh heh",
        "2741b69c3b371bf320f870bfe5de76c7 (11:03): didn't realize it was freed right after",
        "2741b69c3b371bf320f870bfe5de76c7 (11:04): you're building on unix, ya?",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:06): yes",
        "2741b69c3b371bf320f870bfe5de76c7 (11:06): some stuff in here makes valgrind gripe",
        "2741b69c3b371bf320f870bfe5de76c7 (11:06): but seems ok on the face of it",
        "2741b69c3b371bf320f870bfe5de76c7 (11:06): ok grab that diff",
        "2741b69c3b371bf320f870bfe5de76c7 (11:06): (same url)",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:08): hmm",
        "2741b69c3b371bf320f870bfe5de76c7 (11:09): ?",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:09): Well, either it's still broken or DPRINTing an %S is broken.",
        "2741b69c3b371bf320f870bfe5de76c7 (11:09): it's likely that DPRINT %S is broken",
        "2741b69c3b371bf320f870bfe5de76c7 (11:10): ya it's using normal printf()",
        "2741b69c3b371bf320f870bfe5de76c7 (11:10): #define DPRINT1(args...) do { printf(&quot;(%s:%d) &quot;,__FILE__,__LINE__); printf(args)",
        "2741b69c3b371bf320f870bfe5de76c7 (11:10): ; } while(0);",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:10): hmm",
        "2741b69c3b371bf320f870bfe5de76c7 (11:11): let's see how to do this using normal printf (it might not be possible)",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:12): what? now everyone is using gdb ?",
        "2741b69c3b371bf320f870bfe5de76c7 (11:12): hmm",
        "2741b69c3b371bf320f870bfe5de76c7 (11:12): S      (Not in C99, but in SUSv2.)  Synonym for ls.  Don't use.",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:13): encoded: mkhive is a host tool, this gdb for me",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:13): *thus",
        "2741b69c3b371bf320f870bfe5de76c7 (11:14): i bet that %S uses canonical wchar_t size on unixen (traditionally it's sizeof(unsigned int)",
        "2741b69c3b371bf320f870bfe5de76c7 (11:14): that's why it wigs",
        "2741b69c3b371bf320f870bfe5de76c7 (11:15): i'll try a 'speriment",
        "2741b69c3b371bf320f870bfe5de76c7 (11:16): (the same thing might be affecting wcslen actually)",
        "30c0f486a35ace88d39489f7dd46a746 (11:20): 03greatlrd * r24231 10reactos/regtests/winetests/gdi/: remove folder gdi for all gdi test are in gdi32",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:20): ;0)",
        "6c30c79bc333fa9f0c9a01c4b03008d3 (11:20): simple cleanup",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:20): I'm not seeing things I thought I saw, but I'm not sure what I was breaking on anymore",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:21): we need more porn in TRUNK",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:22): ok",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:22): now I've got it again.",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:22): the DPRINT works.",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:23): (tools/mkhive/registry.c:106) RegpOpenOrCreateKey('Registry\\User\\.DEFAULT')",
        "a8ca23b1263a67497231334ce320bb64 (11:23): Ok Portable Object Relocation Management.  Nice hidden joke if we can fit is somewhere.",
        "2741b69c3b371bf320f870bfe5de76c7 (11:23): part of the problem here is that wchar size isn't the same",
        "a8ca23b1263a67497231334ce320bb64 (11:23): Opps swaped word",
        "a8ca23b1263a67497231334ce320bb64 (11:23): Management Network.",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:24): <a href=\"http://rafb.net/paste/results/8eiFti11.html\">http://rafb.net/paste/results/8eiFti11.html</a>",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:24): see the first few that work?",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:27): They are being called by RegCreateKeyW being called directly, the ones that fail are coming via RegCreateKeyA",
        "2741b69c3b371bf320f870bfe5de76c7 (11:27): hmm i see",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:27): Sorry if I am restating this.",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:27): <a href=\"http://rafb.net/paste/results/m2SxGA10.html\">http://rafb.net/paste/results/m2SxGA10.html</a>",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:28): and right there RegCreateKeyA has the correct string.",
        "2741b69c3b371bf320f870bfe5de76c7 (11:30): (tools/mkhive/registry.c:108) sizeof(*KeyName) == 4",
        "2741b69c3b371bf320f870bfe5de76c7 (11:31): this is a fairly big problem, since we're mixing platform wchar_t and stuff that uses windows' WCHAR",
        "2741b69c3b371bf320f870bfe5de76c7 (11:31): moichido (this time with feeling)",
        "2741b69c3b371bf320f870bfe5de76c7 (11:32): we don't use any other wcs* functions than the ones i replaced",
        "2741b69c3b371bf320f870bfe5de76c7 (11:32): i'll check to see if any others are used",
        "2741b69c3b371bf320f870bfe5de76c7 (11:35): oh hell",
        "2741b69c3b371bf320f870bfe5de76c7 (11:35): heh",
        "2741b69c3b371bf320f870bfe5de76c7 (11:37): wow",
        "2741b69c3b371bf320f870bfe5de76c7 (11:38): we can fix the rest of this though",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:38): lol",
        "2741b69c3b371bf320f870bfe5de76c7 (11:38): more on the way soon",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:47): how do i know how many watts a PC might need?",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:48): PSU wise",
        "2741b69c3b371bf320f870bfe5de76c7 (11:48): wax: ok better diff :-)",
        "2741b69c3b371bf320f870bfe5de76c7 (11:48): much quieter valgrind output",
        "2741b69c3b371bf320f870bfe5de76c7 (11:48): i think this is the last thing we needed",
        "2741b69c3b371bf320f870bfe5de76c7 (11:48): unfortunately this means that all strings are now formatted the 'right' way (which is to say that printf won't be able to print any of them)",
        "2741b69c3b371bf320f870bfe5de76c7 (11:49): no more confusion about wchar_t (unix 4 bytes) vs PWCHAR (windows 2 bytes)",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:49): hmmm",
        "2741b69c3b371bf320f870bfe5de76c7 (11:49): any better?",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:49): failed to apply (I had all sorts of things tweaked.",
        "2741b69c3b371bf320f870bfe5de76c7 (11:49): i tweaked a bunch of stuff too",
        "2741b69c3b371bf320f870bfe5de76c7 (11:50): i'm also on the branch",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:50): I'm currently in trunk, but I didn't think this code had been touched.",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:50): /nick HaxDragon",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:50): opps",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:55): Well, it's still not making hives with anything in them",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:55): ;0/",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:57): Maybe this was a red herring... ;0/",
        "2741b69c3b371bf320f870bfe5de76c7 (11:57): i'm guessing that cmlib itself probably makes wchar_t assumptions",
        "2741b69c3b371bf320f870bfe5de76c7 (11:58): an alternate way of doing this is to compile all host tools with -fshort-wchar",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:58): <a href=\"http://www.mitec.cz/wrr.htm\">http://www.mitec.cz/wrr.htm</a>",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:58): i trust you guys have seen the 1st stage logs",
        "2741b69c3b371bf320f870bfe5de76c7 (11:58): and provide our own implementations of wcschr, wcslen etc",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:59): NtCreateKey blah blah blah does not create trees",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:59): Yeah, that's not an error.",
        "d69dc8c061f6093da232e19c85e6b5f2 (11:59): It's a reminder",
        "bddd707e7488c05ab5d30ddb4baa2518 (11:59): its not :/",
        "d69dc8c061f6093da232e19c85e6b5f2 (12:00): Well, thanks for looking, arty.",
        "d69dc8c061f6093da232e19c85e6b5f2 (12:00): It's way past bedtime here. ;0)",
        "d69dc8c061f6093da232e19c85e6b5f2 (12:00): fwiw, that wrr tool can open the hives we generate with the bootcd.",
        "d69dc8c061f6093da232e19c85e6b5f2 (12:01): That made me feel good.",
        "d69dc8c061f6093da232e19c85e6b5f2 (12:02): It can open the ones mkhive makes, but it appears to make a recursively linked folder.",
        "f986c1ee83aea2c951ec3f7db3004090 (12:03): night all",
        "e616a5c411ef7b6ec895672e618d41ba (12:03): gnite wax",
        "6c30c79bc333fa9f0c9a01c4b03008d3 (12:15): arty",
        "6c30c79bc333fa9f0c9a01c4b03008d3 (12:15): I found WideCharToMultiByteCP",
        "6c30c79bc333fa9f0c9a01c4b03008d3 (12:16): when it try convert wchar string to ansi string",
        "6c30c79bc333fa9f0c9a01c4b03008d3 (12:16): it does not termate the string",
        "e616a5c411ef7b6ec895672e618d41ba (12:19): strlen(&quot;thats bad&quot;)+1;",
        "6c30c79bc333fa9f0c9a01c4b03008d3 (12:20): if in some case",
        "30c0f486a35ace88d39489f7dd46a746 (12:29): 03greatlrd * r24232 10reactos/dll/win32/kernel32/misc/nls.c: add NULL termate on ansi string when WideCharToMultiByteCP doing wchar to ansi converting."
    ],
    "person_ids": [
        "d69dc8c061f6093da232e19c85e6b5f2",
        "2741b69c3b371bf320f870bfe5de76c7",
        "e616a5c411ef7b6ec895672e618d41ba",
        "a8ca23b1263a67497231334ce320bb64",
        "bddd707e7488c05ab5d30ddb4baa2518",
        "30c0f486a35ace88d39489f7dd46a746",
        "6c30c79bc333fa9f0c9a01c4b03008d3",
        "f986c1ee83aea2c951ec3f7db3004090"
    ]
}