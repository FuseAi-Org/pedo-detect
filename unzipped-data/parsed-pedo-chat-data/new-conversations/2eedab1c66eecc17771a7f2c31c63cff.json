{
    "id": "2eedab1c66eecc17771a7f2c31c63cff",
    "messages": [
        "673d7d497cb7c30e46ce951bc321aafd (13:12): you are using wrong subnet",
        "503cccb6e0fea43b985626e2d6eda374 (13:13): Hi, question: &quot;Are they packets that are NEW and have one of this flags ACK,FIN,RST,URG,PSH ?&quot; outsie of a scan ports of course",
        "673d7d497cb7c30e46ce951bc321aafd (13:14): how you mean ?",
        "503cccb6e0fea43b985626e2d6eda374 (13:16): every new packet that came to a service is SYN right?",
        "673d7d497cb7c30e46ce951bc321aafd (13:25): depends",
        "673d7d497cb7c30e46ce951bc321aafd (13:25): a new packet is one that currently isnt located to belong to a current state",
        "673d7d497cb7c30e46ce951bc321aafd (13:26): for example a syn + ack is a new packet for outbound connection",
        "673d7d497cb7c30e46ce951bc321aafd (13:26): since the handshake is IN syn -&gt; OUT syn+ack -&gt; IN ack",
        "673d7d497cb7c30e46ce951bc321aafd (13:26): but sure for inbound connections NEW should be where only syn is set",
        "673d7d497cb7c30e46ce951bc321aafd (13:27): but im not 100% sure that this is the case for all type of protocols",
        "673d7d497cb7c30e46ce951bc321aafd (13:28): but that syn+ack packet will most likely trigger in the established row",
        "673d7d497cb7c30e46ce951bc321aafd (13:28): if you log droped packets then you could just test and see what happends :P",
        "503cccb6e0fea43b985626e2d6eda374 (13:29): I'm asking because i'dont know is a good idea to drop all packats NEW that are not SYN, include ACK, and all the rest",
        "503cccb6e0fea43b985626e2d6eda374 (13:30): iptables -A INPUT -p tcp --tcp-flags ALL ACK,FIN,RST,URG,PSH -m state --state NEW -j DROP",
        "673d7d497cb7c30e46ce951bc321aafd (13:30): ahh thats a common rule",
        "503cccb6e0fea43b985626e2d6eda374 (13:30): waht do you say?",
        "673d7d497cb7c30e46ce951bc321aafd (13:30): new not syn",
        "673d7d497cb7c30e46ce951bc321aafd (13:30): iptables -A BADTCP -p tcp ! --syn -m state --state NEW -j BADTCP_DROP",
        "673d7d497cb7c30e46ce951bc321aafd (13:31): you have a badtcp list at <a href=\"http://www.tbg.nu/iptables.txt\">http://www.tbg.nu/iptables.txt</a>",
        "673d7d497cb7c30e46ce951bc321aafd (13:31): also <a href=\"http://lists.netfilter.org/pipermail/netfilter/2004-November/057155.html\">http://lists.netfilter.org/pipermail/netfilter/2004-November/057155.html</a> have a more extended list but i dunno if its complete",
        "503cccb6e0fea43b985626e2d6eda374 (13:31): but ! --syn accept SYN,RST,ACK SYN",
        "673d7d497cb7c30e46ce951bc321aafd (13:32): iptables -A BADTCP -p tcp --tcp-flags SYN,RST SYN,RST -j BADTCP_DROP",
        "673d7d497cb7c30e46ce951bc321aafd (13:32): :P",
        "673d7d497cb7c30e46ce951bc321aafd (13:32): look at the badtcp chain at <a href=\"http://www.tbg.nu/iptables.txt\">http://www.tbg.nu/iptables.txt</a>",
        "503cccb6e0fea43b985626e2d6eda374 (13:35): i see the rules... but with that rules, what happens if i send you a new packet with only a ACK flag ?",
        "503cccb6e0fea43b985626e2d6eda374 (13:35): it will accept it?",
        "673d7d497cb7c30e46ce951bc321aafd (13:40): a new packet with only an ACK will be dropped by          iptables -A BADTCP -p tcp ! --syn -m state --state NEW -j BADTCP_DROP",
        "503cccb6e0fea43b985626e2d6eda374 (13:50): ok, I'am understanding.... =) thanks Apachez",
        "503cccb6e0fea43b985626e2d6eda374 (14:06): Apachez, when you can see it out <a href=\"http://www.e-solux.com.ar/inmolator-fw.tar.gz\">http://www.e-solux.com.ar/inmolator-fw.tar.gz</a>",
        "503cccb6e0fea43b985626e2d6eda374 (14:06): ;)",
        "673d7d497cb7c30e46ce951bc321aafd (14:08): its written in spanish :/",
        "503cccb6e0fea43b985626e2d6eda374 (14:08): yes... but the code is the same from everyone ;)",
        "673d7d497cb7c30e46ce951bc321aafd (14:10): i mean looking at the README is like Manuel from Fawlty Towers: que?",
        "673d7d497cb7c30e46ce951bc321aafd (14:10): :)",
        "503cccb6e0fea43b985626e2d6eda374 (14:11): =)  I'm from Argentina... that?\u00f5 why...  and I don't speek english so well, but then i wil try to translate it =)",
        "673d7d497cb7c30e46ce951bc321aafd (14:15): but other than that I dont understand a word from the comments in the code it looks nice",
        "673d7d497cb7c30e46ce951bc321aafd (14:15): perhaps you should update that antispoof list",
        "503cccb6e0fea43b985626e2d6eda374 (14:17): what i missed?",
        "503cccb6e0fea43b985626e2d6eda374 (14:19): I should update it like <a href=\"http://www.tbg.nu/iptables.txt\">http://www.tbg.nu/iptables.txt</a> ?",
        "673d7d497cb7c30e46ce951bc321aafd (14:20): for example :P",
        "503cccb6e0fea43b985626e2d6eda374 (14:20): ;)"
    ],
    "person_ids": [
        "673d7d497cb7c30e46ce951bc321aafd",
        "503cccb6e0fea43b985626e2d6eda374"
    ]
}