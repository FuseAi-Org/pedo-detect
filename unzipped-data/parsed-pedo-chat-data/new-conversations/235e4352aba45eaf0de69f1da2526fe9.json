{
    "id": "235e4352aba45eaf0de69f1da2526fe9",
    "messages": [
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (19:59): anyone give me some help on making the 10.1.1.2:22 to make it the default ssh server on 10.1.1.1/0 ? the server machine is the 10.1.1.1. any idea ?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:06): anyone please ?",
        "de76c8e6cbbc3c1c44788a340cac141e (20:06): what do you mean by &quot;default ssh server&quot;?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:08): ex: if someone runs: ssh $my_ip to connect to the 10.1.1.2 ssh server insteed of mine..",
        "de76c8e6cbbc3c1c44788a340cac141e (20:09): not sure why you would want that...",
        "de76c8e6cbbc3c1c44788a340cac141e (20:10): anyway, it can be done, with a DNAT and SNAT rule on the default gateway",
        "de76c8e6cbbc3c1c44788a340cac141e (20:10): second URL in topic should help",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:10): danieldg: can you give an example cause i try some rules without success ..",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:11): danieldg: that rules i used..",
        "de76c8e6cbbc3c1c44788a340cac141e (20:11): you need two rules: one DNAT and one SNAT",
        "de76c8e6cbbc3c1c44788a340cac141e (20:12): and this must be done on the default gateway of 10.1.1.1/24",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:12): sure.",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:12): can you tell me what are the correct commands ?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:12): mine ip 10.1.1.1",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:12): other ip 10.1.1.2",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:13): and internet. 62.74.160.80 but it is not static",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:14): danieldg: can you ?",
        "de76c8e6cbbc3c1c44788a340cac141e (20:14): what have you tried?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:15): iptables -t nat -A PREROUTING -p tcp --dport 22 -j DNAT --to-destination 10.1.1.2",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:16): iptables -t nat -A POSTROUTING -p tcp --dport 22 -j SNAT --to-source 10.1.1.2",
        "de76c8e6cbbc3c1c44788a340cac141e (20:16): the SNAT source needs to be the IP of the firewall",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:16): when you say the ip of the firewall?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:17): 10.1.1.1 ?",
        "de76c8e6cbbc3c1c44788a340cac141e (20:17): the IP of the machine running the iptables command",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:17): so the 10.1.1.1",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:18): i do that but it still cant connect",
        "de76c8e6cbbc3c1c44788a340cac141e (20:18): where are you trying from?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:18): i am trying to connect from the 10.1.1.2 via : ssh 62.74.160.80",
        "de76c8e6cbbc3c1c44788a340cac141e (20:19): and it has 10.1.1.1 as default gateway?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:19): yes.. the 10.1.1.2 can access internet",
        "05d47a27f3c818abbf125051a57b268c (20:20): borbo:  try iptables -t nat -A PREROUTING -d 10.1.1.1 -p tcp --dport 22 -j DNAT --to 10.1.1.2",
        "de76c8e6cbbc3c1c44788a340cac141e (20:20): that's the same rule he already has...",
        "05d47a27f3c818abbf125051a57b268c (20:20): danieldg:  no it's not",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:20): Johnny23|work: ok",
        "de76c8e6cbbc3c1c44788a340cac141e (20:20): Johnny23|work: ok, what's the important difference?",
        "05d47a27f3c818abbf125051a57b268c (20:21): danieldg:  -d 10.1.1.1",
        "de76c8e6cbbc3c1c44788a340cac141e (20:21): which he doesn't want - since that'll only make it work for packets going to 10.1.1.1",
        "05d47a27f3c818abbf125051a57b268c (20:22): danieldg:  if it works its a start",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:22): Johnny23|work: it not working.",
        "de76c8e6cbbc3c1c44788a340cac141e (20:22): borbo: do you have other rules in POSTROUTING?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:22): nope",
        "de76c8e6cbbc3c1c44788a340cac141e (20:22): maxine: show ruleset",
        "d949efae795da71ef603b60b018d191c (20:22): Please post the output of &quot;iptables-save -c&quot; or, if that is not available, &quot;iptables -vnL&quot; to a pastebin such as pastebin.ca, and tell us the resulting URL. Include the network setup if it is not immediately obvious",
        "de76c8e6cbbc3c1c44788a340cac141e (20:23): borbo: then how are you doing NAT?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:23): danieldg: MASQUERADE  all  --  0.0.0.0/0            0.0.0.0/0",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:23): sorry i thought that you say PREROUTING",
        "de76c8e6cbbc3c1c44788a340cac141e (20:24): does that rule have an interface on it?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:24): in * , out ppp0",
        "de76c8e6cbbc3c1c44788a340cac141e (20:24): ok. and the SNAT rule is right after that? only two rules?",
        "de76c8e6cbbc3c1c44788a340cac141e (20:25): are you blocking stuff in FORWARD?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:25): ok wait to pastebin",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:26): the iptables-save output is without the DNAT SNAT that i add afterwards.",
        "de76c8e6cbbc3c1c44788a340cac141e (20:27): afterwards? you mean it's not there right now?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:27): i do /etc/init.d/iptables restart.",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:29): <a href=\"http://pastebin.ca/78775\">http://pastebin.ca/78775</a>",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:29): there is..",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:30): now i must add the other rules to make 10.1.1.2:22 to be access insteed the 10.1.1.1:22",
        "de76c8e6cbbc3c1c44788a340cac141e (20:30): iptables -A FORWARD -i eth0 -o eth0 -j ACCEPT",
        "de76c8e6cbbc3c1c44788a340cac141e (20:30): or look at the logs to see everything you were dropping",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:32): danieldg: ok i do that command.",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:33): next ?",
        "de76c8e6cbbc3c1c44788a340cac141e (20:33): does it work?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:33): what to work ?",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:36): what i must add to my firewall to make the connections to the 10.1.1.1:22 to be redirected to 10.1.1.2:22",
        "de76c8e6cbbc3c1c44788a340cac141e (20:37): the DNAT and SNAT rules...",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:37): danieldg: the command that you told me about -i eth0 -o eth0 -j ACCEPT .. whats is for ?",
        "de76c8e6cbbc3c1c44788a340cac141e (20:38): accepting the redirected connection",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:41): danieldg: not working",
        "de76c8e6cbbc3c1c44788a340cac141e (20:41): pastebin the iptables-save output now",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:42): ok",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:43): <a href=\"http://pastebin.ca/78788\">http://pastebin.ca/78788</a>",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:45): what do you suggest..",
        "de76c8e6cbbc3c1c44788a340cac141e (20:46): looks like it should be working",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:48): nope its not",
        "de76c8e6cbbc3c1c44788a340cac141e (20:48): run tcpdump or ethereal somewhere",
        "de76c8e6cbbc3c1c44788a340cac141e (20:49): you should see the packets being send from .2 to .1, and then back from .1 to .2",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:49): ok i will give it a try",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:49): thanks any way.. if i dont fix it until night ill be back",
        "aa8e3d16e2db37e6c0abacf4d2f9c184 (20:50): thanks anyway ;)"
    ],
    "person_ids": [
        "aa8e3d16e2db37e6c0abacf4d2f9c184",
        "de76c8e6cbbc3c1c44788a340cac141e",
        "05d47a27f3c818abbf125051a57b268c",
        "d949efae795da71ef603b60b018d191c"
    ]
}