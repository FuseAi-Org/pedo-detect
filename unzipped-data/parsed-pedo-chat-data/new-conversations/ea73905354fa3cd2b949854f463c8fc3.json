{
    "id": "ea73905354fa3cd2b949854f463c8fc3",
    "messages": [
        "d770d01baf68068d340c8ab95d251419 (23:16): help testing my firewall",
        "46760632fe3926290a2d59541c376a65 (23:30): /dev/brain&quot;)",
        "3a941a2f682a34ccb813e8745b469462 (23:36): where does iptables store its rules?",
        "49dc63428f8a5cedb84426c3c1a530c1 (23:40): fyrestrtr: kernel memory",
        "3a941a2f682a34ccb813e8745b469462 (23:40): so you are saying that I have to manually enter all the rules at system startup, via a script?",
        "49dc63428f8a5cedb84426c3c1a530c1 (23:41): fyrestrtr: yes. there is iptables-save &amp; iptables-restore binary to assist you in that task",
        "49dc63428f8a5cedb84426c3c1a530c1 (23:41): fyrestrtr: most of the time, the distro you are using provide a /etc/init.d script for such",
        "49dc63428f8a5cedb84426c3c1a530c1 (23:41): exemple: /etc/init.d/iptables save",
        "3a941a2f682a34ccb813e8745b469462 (23:43): ah okay, sorry for the questions peejix -- I've just spent the past 4 hours trying to setup a server as a gateway, and I am just ... lost :( Everything is working okay (forwarding, masquerading) but I cannot figure out how to add some rules to the firewall for specific ports/services.",
        "3a941a2f682a34ccb813e8745b469462 (23:47): on logging, how do I append the interface for which the packet has been logged?",
        "49dc63428f8a5cedb84426c3c1a530c1 (23:50): fyrestrtr: you cannot do that using a single rule. You need a rule for each interface you want to log and use --log-prefix to specify what interface",
        "43d2e4c8ebdceba76435c1f675f8d628 (23:53): correct me if I'm wrong, but the in and out interfaces, if applicable, are in every iptables log",
        "d770d01baf68068d340c8ab95d251419 (23:57): i need someone to help me test my firewall",
        "3a941a2f682a34ccb813e8745b469462 (23:57): guys, can you please have a look at this <a href=\"http://pastebin.com/721110\">http://pastebin.com/721110</a> -- I don't know if I'm doing anything wrong/right. I am trying to block everything, except SMTP port.",
        "3a941a2f682a34ccb813e8745b469462 (23:58): then I would like to add additional exceptions -- basic policy is, block everything, only allows those that are listed.",
        "d770d01baf68068d340c8ab95d251419 (23:59): what do you see in a webouser  https://marinadecascais.no-ip.info:10000/   ???",
        "3a941a2f682a34ccb813e8745b469462 (00:01): mariooliveira: can't connect.",
        "d770d01baf68068d340c8ab95d251419 (00:01): good",
        "d770d01baf68068d340c8ab95d251419 (00:01): what is your ip adress so i can allow it",
        "49dc63428f8a5cedb84426c3c1a530c1 (00:02): trappist: yeah, you're right!",
        "3a941a2f682a34ccb813e8745b469462 (00:03): peejix: any idea on my pastebin? :)",
        "d770d01baf68068d340c8ab95d251419 (00:06): im not very good with iptables",
        "4801ede7c3cb42514be3a1cc41de5e1b (00:07): die produktivit\u2030t der leute ist invers proportional zu ihrem auftreten im #tuwien&quot;)",
        "d770d01baf68068d340c8ab95d251419 (00:07): what is your ip  so i can try to enable in my firewall",
        "d770d01baf68068d340c8ab95d251419 (00:12): whats your ip adress joga so i can enable on my firewall",
        "3a941a2f682a34ccb813e8745b469462 (00:16): gaaah!!! how do I enable port 25 to be forwarded to the internet?!?! -- the incoming is working, the outgoing -- nope.",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:21): mariooliveira: you're definitly wrong trying to filter ppl from the net with their mac adress",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:23): mac adress is at ethernet layer (2), and does only have a meaning inside your ethernet segment from your computer point of view",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:24): every ppl coming from the internet will be seen at layer 2 as your default gw's (mostly) mac adress",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:24): look for some network courses",
        "3a941a2f682a34ccb813e8745b469462 (00:32): matth_: can you help me with something, please?",
        "3a941a2f682a34ccb813e8745b469462 (00:34): I am trying to forward port 25 from the local net interface, to the external interface using <a href=\"http://pastebin.com/721110\">http://pastebin.com/721110</a> -- but I cannot telnet on 25 from the host, any idea?",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:40): I see a problem",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:41): iptables -I FORWARD -i $INTERNET -p tcp -s $MAILSERVER --dport 25 -j ACCEPT",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:41): you want to allow -d $MAILSERVER instead I guess",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:42): If you want to allow people from the internet to reach you mailserver inside your private lan",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:43): another thing, they won't contact $MAILSERVER:25 but instead $ROUTER:25",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:43): so they will hit the INPUT chain",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:44): you got to enable incoming tcp/25 to your routing box",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (00:44): does that sound ok ?",
        "3a941a2f682a34ccb813e8745b469462 (00:55): yeah",
        "3a941a2f682a34ccb813e8745b469462 (00:56): I guess -- I am swimming in routers, chains, rules right now.",
        "3a941a2f682a34ccb813e8745b469462 (00:56): basically, I need only one machine -- that $MAILSERVER to be able to talk on 25 and receive on 25, no one else.",
        "3a941a2f682a34ccb813e8745b469462 (00:59): god damn this $%$$^@$%$@%$@",
        "3a941a2f682a34ccb813e8745b469462 (01:01): I can't get port 25 open!",
        "3a941a2f682a34ccb813e8745b469462 (01:01): its 23:01 right now, been doing this since 15:00",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:02): heh that took me around 1mn to test it on my setup :p",
        "3a941a2f682a34ccb813e8745b469462 (01:03): okay *sigh* -- how do I start from scratch?",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:03): how do you diagnose that ?",
        "3a941a2f682a34ccb813e8745b469462 (01:03): telnet gmail.com 25 &lt;-- from the $MAILSERVER",
        "3a941a2f682a34ccb813e8745b469462 (01:03): also, none of my emails are going out.",
        "3a941a2f682a34ccb813e8745b469462 (01:04): can I clear all the rules except masq + forwarding? Otherwise, I will lose my connection to the internet.",
        "3a941a2f682a34ccb813e8745b469462 (01:05): my latest attempt was to use <a href=\"http://www.malibyte.net/iptables/scripts/fwscripts.html\">http://www.malibyte.net/iptables/scripts/fwscripts.html</a>",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:05): before starting from scratch just diagnose a little bit to see where that's blocking",
        "3a941a2f682a34ccb813e8745b469462 (01:06): well the thing is, I don't know how to clear it out because I have been adding rules, modifying them, etc. etc.",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:06): did you modify the conf since <a href=\"http://pastebin.com/721110\">http://pastebin.com/721110</a> ?",
        "3a941a2f682a34ccb813e8745b469462 (01:06): LOL yeah -- err, a LOT.",
        "3a941a2f682a34ccb813e8745b469462 (01:07): I actually just wrote that conf myself to keep track of what I was doing.",
        "3a941a2f682a34ccb813e8745b469462 (01:07): then I started adding things.",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:07): is the first route line really useful ?",
        "3a941a2f682a34ccb813e8745b469462 (01:08): no, I just added that in there as a reminder",
        "3a941a2f682a34ccb813e8745b469462 (01:08): I don't actually run that script, its just a series of steps that I am doing.",
        "3a941a2f682a34ccb813e8745b469462 (01:08): and I added the variables there to keep track of my interfaces.",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:08): you may write a script that clears everything and set every rules",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:08): and modify that one",
        "3a941a2f682a34ccb813e8745b469462 (01:09): yes that's what I would like to do (that's what I was trying to do with my pastebin.",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:09): then you'll be sure of what youre doing, and what are the effect of each mods",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:09): just an advice, I'm working like that",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:11): another remark, I do not see any -P for the FORWARD rule, I guess that'll be ACCEPT by default, but mention it just in case",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:13): about the $MAILSERVER not being able to acces any_net_serv:25",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:13): you need something like : iptables -I FORWARD -i $LOCALNET -p tcp -s $MAILSERVER --dport 25 -j ACCEPT",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:14): (and not -i $INTERNET)",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:14): just think about what you write, where packets arrives, and how does they look like (src, dst) and everything should be fine",
        "13fbb6cc9f88ccfc50845bb81132b4d4 (01:17): (you also probably want a '-m state' rule in the FORWARD chain)"
    ],
    "person_ids": [
        "d770d01baf68068d340c8ab95d251419",
        "46760632fe3926290a2d59541c376a65",
        "3a941a2f682a34ccb813e8745b469462",
        "49dc63428f8a5cedb84426c3c1a530c1",
        "43d2e4c8ebdceba76435c1f675f8d628",
        "4801ede7c3cb42514be3a1cc41de5e1b",
        "13fbb6cc9f88ccfc50845bb81132b4d4"
    ]
}